# Chapter 2 머신러닝 프로젝트 처음부터 끝까지

## 1. 큰 그림 보기

* ### 문제 정의

직면한 문제를 정의하는 게 필요하다. ex) 지도, 비지도, 강화학습중 무엇인지, 회귀, 분류중 어떻게 문제를 해결해야 하는지 등을 정의해야 한다.

> 문제상황)  중간 주택 가격 추정하기
>
> * **지도학습**(레이블된 훈련 샘플이 있으므로)
>
> * **회귀 문제**(주택 가격을 예측해야하므로)
>
>   예측에 사용될 특성이 여러개 이므로 **다중 회귀** 라 볼수 있다.
>
> * **단변량 회귀** (구역마다 하나의 주택 가격을 측정한다면)

✔ **파이프 라인**: 데이터 처리 컴포넌트들이 연속되어 있는 것

* ### 성능 지표 선택

  * #### 평균 제곱근 오차(Root Mean Square Error)

  $$
  RMSE(X,h)=\sqrt{\frac{1}{m}\displaystyle \sum_{i=1}^m(h(x^{(i)})-y^{(i)})^2}
  $$

  * #### 평균 절대 오차(Mean Absolute Error)

    $$
    MAX(X, h) = \frac{1}{m}\displaystyle \sum_{i=1}^m |h(x^{(i)} - y^{(i)})|
    $$

    >m: RSME를 측정할 데이터 셋에 있는 샘플 수
    >
    >$x^{(i)}$:  데이터셋에 있는 i번째 샘플의 전체 특성값 벡터
    >
    >$y^{(i)}$: 해당 레이블(해당 샘플의 기대 출력값, 정답값)
    >
    >h: 시스템의 예측함수, 가설 

## 2. 데이터 가져오기

1. ####  작업환경설치

   Jupyter Notebook, Numpy, Pandas, Matplotlib, Scikit learn 등등 설치

   ✔ **독립적인 개발환경 만들기**

   * 다른 프로젝트의 라이브러리 버전과 충돌하는 것을 피하기 위해 독립적인 개발환경은 만든다.
   * virtualenv를 설치

2. #### 데이터 다운로드

3. #### 데이터 구조 훑어보기

   ✔ **주요 method**

   >`.head()`: Dataframe의 처음 다섯행을 확인한다.
   >
   >`.info()`: 데이터에 대한 간략한 설명과 전체 행 수, 각 특성의 자료형과 Null이 아는 값의 개수를 확인할 				  때 유용
   >
   >`.value_counts()`: 어떤 카테고리가 있고 각 카테고리마다 얼마나 많은 구역이 있는 지 보여준다.
   >
   >`.describe()`: 수치형 데이터들의 특성의 요약정보를 보여준다.

4. #### 데이터 세트 만들기

   Test Dataset 만들기: **무작위**로 어떤 샘플을 선택하여 데이터셋의 20% 정도를 떼어놓으면 된다.

   ✔ **계층적 샘플링**: 데이터셋이 충분히 크지 않다면 샘플링 편향이 생길 수 있다. 예를들어 미국인구의 51.3% 가 여자이고 48.7%가 남자인 경우 전화번호부 1000명을 뽑을 때 이 비율에 맞게 뽑아야 한다.이를 계층적 샘플링 이라한다.

## 3. 데이터 이해를 위한 탐색과 시각화

* ### 데이터 시각화

  데이터 특성이 잘 드러날 수 있는 방법으로 시각화하여 데이터를 살펴본다.

  ex) 지리적 데이터 ❯ 산점도(scatter plot)를 통한 시각화

* ### 상관관계 조사

  보통 `corr()`메소드를 통해 쉽게 계산할 수 있다.

  ✔ 상관관계의 범위: **-1 < 상관관계 < 1**

  * -1에 가까울 수록: 양의 상관관계(**비례**)

  * 1에 가까울 수록: 음의 상관관계(**반비례**)

## 4. 머신러닝 알고리즘을 위한 데이터 준비

* ### 데이터 정제

  ✔ **누락된 특성 다루기**

  * 해당 특성 전체 제거(`drop()`이용)
  * 누락치가 있는 행을 제거한다(`dropna()`이용)
  * 어떤 값으로 채운다.(0, 평균, 중간값 등)(`fillna()`이용)

* ### 텍스트와 범주형 특성 다루기

  수치형 데이터들을 임의의 기준을 통해 카테고리화 시켜 범주형 데이터로 바꾼다.

* ### 특성 스케일링

  입력 숫자 특성들의 스케일이 많이 다르면 머신러닝 알고리즘이 잘 작동하지 않는다.

  따라서 모든 특성의 범위를 같게 만들어 주는 방법으로 **min-max 스케일링**과 **standardization(표준화)**가 널리 쓰인다.

  * **min-max 스케일링**: $\frac{데이터 - min}{max - min}$ 을 통해 데이터를 0과 1 범위에 들도록 값을 이동시킨다.

    &#10095; 이상치에 영향을 많이 받는다.

  *  **standardization(표준화)**: $\frac{데이터 - 평균}{표준편차}$ 를 통해 데이터 결과 분포의 분산이 1이 되도록 한다.

    &#10095; 이상치에 영향을 덜 받는다.

  

* ### 변환 파이프라인

  

## 5. 모델 선택과 훈련

* ### 훈련세트에서 훈련하고 평가하기

* ### 교차검증을 사용한 평가





## 6. 모델 세부 튜닝

* ### 그리드 탐색

* ### 랜덤 탐색

* ### 앙상블 방법

* ### 최상의 모델과 오차 분석

  

















